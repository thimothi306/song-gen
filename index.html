<!DOCTYPE html>
<html lang="te">
<head>
  <meta charset="UTF-8" />
  <title>Song Sheet Generator (Telugu - A4)</title>

  <!-- Telugu-friendly font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+Telugu:wght@400;600&display=swap">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&display=swap">

  <style>
   * {
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 0;
  font-family: "Noto Sans Telugu", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 50%, #1e40af 100%);
  min-height: 100vh;
}

.app {
  max-width: 1100px;
  margin: 0 auto;
  padding: 16px;
}

h1 {
  font-size: 32px;
  margin-bottom: 4px;
  color: #e0e7ff;
  font-weight: 700;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
  font-family: "Playfair Display", serif;
}

.subtitle {
  font-size: 15px;
  color: #c7d2fe;
  margin-bottom: 16px;
  letter-spacing: 0.5px;
}

.card {
  background: linear-gradient(135deg, #ffffff 0%, #f0f4ff 100%);
  border-radius: 16px;
  padding: 24px;
  margin-bottom: 16px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.15), 0 0 0 1px rgba(255,255,255,0.5);
  border: 1px solid rgba(199, 210, 254, 0.3);
}

.row {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  align-items: center;
  margin-bottom: 8px;
}

label {
  font-size: 14px;
  font-weight: 600;
  color: #1e3a8a;
}

textarea {
  width: 100%;
  min-height: 220px;
  border-radius: 12px;
  border: 2px solid #c7d2fe;
  padding: 12px;
  font-size: 14px;
  font-family: "Noto Sans Telugu", system-ui, sans-serif;
  resize: vertical;
  background: #fafbff;
  transition: all 0.3s ease;
}

textarea:focus,
select:focus {
  outline: none;
  border-color: #1e40af;
  box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
  background: #ffffff;
}

select,
input[type="number"] {
  border-radius: 10px;
  border: 2px solid #c7d2fe;
  padding: 6px 10px;
  font-size: 14px;
  background: #ffffff;
  color: #1e3a8a;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

select:hover,
input[type="number"]:hover {
  border-color: #1e40af;
}

button {
  border: none;
  border-radius: 12px;
  padding: 10px 20px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%);
  color: white;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3);
}

button:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(30, 64, 175, 0.4);
  background: linear-gradient(135deg, #1e3a8a 0%, #172554 100%);
}

button:active {
  transform: scale(0.98);
}

.hint {
  font-size: 12px;
  color: #4338ca;
  margin-top: 8px;
  background: rgba(199, 210, 254, 0.2);
  padding: 10px 12px;
  border-radius: 8px;
  border-left: 4px solid #1e40af;
}

.preview-wrapper {
  margin-top: 12px;
}

.preview-header {
  margin-bottom: 8px;
  font-size: 14px;
  color: #c7d2fe;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  font-weight: 600;
}

.preview-box {
  border-radius: 16px;
  background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 50%);
  padding: 12px;
  overflow: auto;
  max-height: 70vh;
  border: 2px solid rgba(199, 210, 254, 0.3);
}

/* PRINT layout ------------------------------------ */
@page {
  size: A4;
  margin: 12mm;
}

@media print {
  body {
    background: white;
  }

  .no-print {
    display: none !important;
  }

  .preview-box {
    border: none;
    padding: 0;
    max-height: none;
    overflow: visible;
    background: white;
  }

  .sheet {
    box-shadow: none;
    margin: 0;
  }
}

/* A4 SHEET FORMATTING */
.sheet {
  background: white;
  padding: 4mm;
  margin: 0 auto 0;
  min-height: 260mm;
  box-shadow: none;
  column-gap: 6mm;
  column-fill: balance;
  border-radius: 0;
  border: none;
}

/* Columns switch */
.columns-2 {
  column-count: 2;
}

.columns-1 {
  column-count: 1;
  text-align: center;
}

.columns-1 .song {
  display: inline-block;
  text-align: center;
  width: 100%;
}

/* SONG BLOCK */
.song {
  margin-bottom: 3px;
  padding-bottom: 2px;
  border-bottom: 1px solid #e0e7ff;
}

/* Title should NEVER split by column break */
.song-title {
  font-size: 14px;
  font-weight: 700;
  margin-bottom: 1px;
  break-inside: avoid;
  color: #1e40af;
}

.song-body {
  font-size: 12px;
  line-height: 1.2;
  white-space: pre-line;
  color: #1f2937;
}

/* Number small style */
.song-number {
  font-size: 11px;
  color: #818cf8;
  margin-right: 6px;
  font-weight: 600;
}

.controls-inline {
  display: inline-flex;
  gap: 12px;
  align-items: center;
  flex-wrap: wrap;
}

/* Church name header on sheet */
.church-header {
  text-align: center;
  margin-bottom: 6px;
  padding-bottom: 4px;
  border-bottom: 2px solid #1e40af;
  font-size: 15px;
  font-weight: 700;
  color: #1e40af;
  letter-spacing: 0.5px;
  column-span: all;
}

  </style>
</head>
<body>
  <div class="app">
    <div class="no-print">
      <h1>‚ú® Song Sheet Generator</h1>
      <div class="subtitle">
        Telugu ¬∑ Lyrics only ¬∑ A4 ¬∑ Auto layout (2 columns) ¬∑ Spiritual Collection
      </div>

      <div class="card">
        <div class="row">
          <div style="flex:1 1 200px;">
            <label for="churchName">‚õ™ Church Name (Optional):</label>
          </div>
          <input type="text" id="churchName" placeholder="e.g., Living Hope Church" style="flex:1 1 250px; padding: 8px 12px; border-radius: 10px; border: 2px solid #c7d2fe; font-size: 14px;">
        </div>

        <div class="row" style="margin-top: 12px;">
          <div style="flex:1 1 200px;">
            <label for="rawInput">‚úçÔ∏è Paste all songs here:</label>
          </div>
        </div>

        <textarea id="rawInput" placeholder="‡∞â‡∞¶‡∞æ‡∞π‡∞∞‡∞£:

Yesu Naa Rakshakudu
‡∞≤‡±à‡∞®‡±ç 1
‡∞≤‡±à‡∞®‡±ç 2
‡∞≤‡±à‡∞®‡±ç 3

---
Naa Prabhu Naa Devudu
‡∞≤‡±à‡∞®‡±ç 1
‡∞≤‡±à‡∞®‡±ç 2
"></textarea>

        <div class="hint">
          üëâ ‡∞™‡±ç‡∞∞‡∞§‡∞ø ‡∞™‡∞æ‡∞ü ‡∞Æ‡∞ß‡±ç‡∞Ø‡∞≤‡±ã ‡∞í‡∞ï ‡∞≤‡±à‡∞®‡±ç‚Äå‡∞≤‡±ã <strong>---</strong> (‡∞Æ‡±Ç‡∞°‡±Å ‡∞°‡∞æ‡∞∑‡±ç‚Äå‡∞≤‡±Å) ‡∞™‡±Ü‡∞ü‡±ç‡∞ü‡∞Ç‡∞°‡∞ø.<br />
          üëâ ‡∞™‡±ç‡∞∞‡∞§‡∞ø ‡∞¨‡±ç‡∞≤‡∞æ‡∞ï‡±ç‚Äå‡∞≤‡±ã <strong>‡∞Æ‡±ä‡∞¶‡∞ü‡∞ø ‡∞≤‡±à‡∞®‡±ç ‡∞™‡∞æ‡∞ü ‡∞ü‡±à‡∞ü‡∞ø‡∞≤‡±ç</strong> ‡∞ó‡∞æ ‡∞§‡±Ä‡∞∏‡±Å‡∞ï‡±Å‡∞Ç‡∞ü‡∞æ‡∞Ç.
        </div>

        <div class="row" style="margin-top:10px;">
          <div class="controls-inline">
            <label for="fontSize">üìè Font size:</label>
            <select id="fontSize">
              <option value="11">Extra Small (11)</option>
              <option value="12">Small (12)</option>
              <option value="13" selected>Normal (13)</option>
              <option value="14">Large (14)</option>
              <option value="15">Extra Large (15)</option>
              <option value="16">XXL (16)</option>
              <option value="17">XXXL (17)</option>
              <option value="18">Giant (18)</option>
            </select>

            <label for="columns">üìÑ Columns:</label>
            <select id="columns">
              <option value="2" selected>2 columns</option>
              <option value="1">1 column</option>
            </select>
          </div>

          <div style="margin-left:auto;">
            <button id="generateBtn">
              ‚öôÔ∏è Generate Sheets
            </button>
          </div>
        </div>

        <div style="margin-top: 16px; padding-top: 16px; border-top: 2px solid #c7d2fe;">
          <div style="margin-bottom: 12px;">
            <label style="font-weight: 700; color: #1e3a8a; font-size: 15px;">üìã Auto-fit Pages (Optional)</label>
            <div class="hint" style="margin-top: 6px;">
              Enable this to automatically adjust font sizes based on total songs and pages. Font size dropdown will be disabled.
            </div>
          </div>

          <div class="row">
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
              <input type="checkbox" id="autoFitToggle" style="width: 18px; height: 18px; cursor: pointer;">
              <span style="color: #1e3a8a; font-weight: 500;">Enable Auto-fit</span>
            </label>
          </div>

          <div class="row" style="margin-top: 12px; gap: 20px; display: none;" id="autoFitOptions">
            <div style="flex: 1 1 200px;">
              <label for="totalSongs">Total Songs:</label>
              <input type="number" id="totalSongs" min="1" max="100" value="20" style="width: 100%; padding: 8px 10px; border-radius: 10px; border: 2px solid #c7d2fe;">
            </div>

            <div style="flex: 1 1 200px;">
              <label for="totalPages">Total Pages:</label>
              <select id="totalPages" style="width: 100%; padding: 8px 10px; border-radius: 10px; border: 2px solid #c7d2fe;">
                <option value="1">1 Page (Front only)</option>
                <option value="2" selected>2 Pages (Front & Back)</option>
                <option value="3">3 Pages</option>
                <option value="4">4 Pages</option>
                <option value="5">5 Pages</option>
              </select>
            </div>

            <div style="flex: 1 1 200px;">
              <label for="sheetsPerPage">Sheets per Page:</label>
              <select id="sheetsPerPage" style="width: 100%; padding: 8px 10px; border-radius: 10px; border: 2px solid #c7d2fe;">
                <option value="1" selected>1 Sheet per Page</option>
                <option value="2">2 Sheets per Page</option>
              </select>
            </div>
          </div>

          <div style="margin-top: 12px; padding: 12px; background: rgba(30, 64, 175, 0.08); border-radius: 8px; border-left: 4px solid #1e40af; display: none;" id="autoFitInfo">
            <div style="font-size: 13px; color: #1e3a8a; font-weight: 500;">
              üìä <span id="songCountDisplay"></span> songs will fit in <span id="pageCountDisplay"></span> pages ‚Ä¢ Font size: <span id="fontSizeDisplay" style="font-weight: 700; color: #1e40af;"></span>px
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="card preview-wrapper">
      <div class="preview-header no-print">
        <div>üîç Preview (what will be printed on A4)</div>
        <div class="controls-inline">
          <button onclick="window.print()">üñ®Ô∏è Print</button>
        </div>
      </div>

      <div class="preview-box">
        <div id="sheetsContainer">
          <!-- Generated content goes here -->
          <div class="sheet columns-2" id="emptyState">
            <div style="font-size:13px; color:#a5b4fc;">
              ‡∞™‡±à‡∞® ‡∞â‡∞®‡±ç‡∞® ‡∞¨‡∞æ‡∞ï‡±ç‡∞∏‡±ç‚Äå‡∞≤‡±ã ‡∞™‡∞æ‡∞ü‡∞≤‡±Å ‡∞™‡±á‡∞∏‡±ç‡∞ü‡±ç ‡∞ö‡±á‡∞∏‡∞ø <b>"Generate Sheets"</b> ‡∞®‡±ä‡∞ï‡±ç‡∞ï‡∞Ç‡∞°‡∞ø.  
              ‡∞á‡∞ï‡±ç‡∞ï‡∞° ‡∞™‡±ç‡∞∞‡∞ø‡∞Ç‡∞ü‡±ç ‡∞Ö‡∞µ‡±Å‡∞ü‡±ç ‡∞é‡∞≤‡∞æ ‡∞µ‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡±ã ‡∞ö‡±Ç‡∞™‡∞ø‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø.
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <script>
    const rawInput = document.getElementById("rawInput");
    const churchName = document.getElementById("churchName");
    const fontSizeSelect = document.getElementById("fontSize");
    const columnsSelect = document.getElementById("columns");
    const generateBtn = document.getElementById("generateBtn");
    const sheetsContainer = document.getElementById("sheetsContainer");
    const emptyState = document.getElementById("emptyState");
    
    // Auto-fit variables
    const autoFitToggle = document.getElementById("autoFitToggle");
    const autoFitOptions = document.getElementById("autoFitOptions");
    const totalSongsInput = document.getElementById("totalSongs");
    const totalPagesSelect = document.getElementById("totalPages");
    const sheetsPerPageSelect = document.getElementById("sheetsPerPage");

    // Toggle auto-fit options visibility
    autoFitToggle.addEventListener("change", () => {
      autoFitOptions.style.display = autoFitToggle.checked ? "flex" : "none";
      fontSizeSelect.disabled = autoFitToggle.checked;
      if (rawInput.value.trim()) {
        generateSheets();
        updateAutoFitInfo();
      }
    });

    // Update on auto-fit value changes
    totalSongsInput.addEventListener("change", () => {
      if (rawInput.value.trim()) {
        generateSheets();
        updateAutoFitInfo();
      }
    });
    totalPagesSelect.addEventListener("change", () => {
      if (rawInput.value.trim()) {
        generateSheets();
        updateAutoFitInfo();
      }
    });
    sheetsPerPageSelect.addEventListener("change", () => {
      if (rawInput.value.trim()) {
        generateSheets();
        updateAutoFitInfo();
      }
    });

    function updateAutoFitInfo() {
      const autoFitInfo = document.getElementById("autoFitInfo");
      if (!autoFitToggle.checked) {
        autoFitInfo.style.display = "none";
        return;
      }

      const text = rawInput.value.trim();
      if (!text) return;

      const rawSongs = text.split(/\n-{3,}\n/g).filter(s => s.trim().length > 0);
      const actualSongCount = rawSongs.length;
      const totalPages = parseInt(totalPagesSelect.value, 10) || 2;
      const sheetsPerPage = parseInt(sheetsPerPageSelect.value, 10) || 1;
      const totalSheets = totalPages * sheetsPerPage;
      const songsPerSheet = Math.ceil(actualSongCount / totalSheets);
      const fontSize = calculateAutoFitFontSize(actualSongCount);

      document.getElementById("songCountDisplay").textContent = actualSongCount;
      document.getElementById("pageCountDisplay").textContent = totalSheets + " sheets";
      document.getElementById("fontSizeDisplay").textContent = fontSize;

      autoFitInfo.style.display = "block";
    }

    function calculateAutoFitFontSize(actualSongCount) {
      const totalPages = parseInt(totalPagesSelect.value, 10) || 2;
      const sheetsPerPage = parseInt(sheetsPerPageSelect.value, 10) || 1;
      
      // Total A4 sheets = physical pages √ó sheets per page
      const totalSheets = totalPages * sheetsPerPage;
      
      // ALL songs must fit in the selected sheets
      const songsPerSheet = actualSongCount / totalSheets;
      
      // Aggressive font sizing to fit ALL songs
      // More songs = much smaller font
      let fontSize = 13; // default
      
      if (songsPerSheet > 50) {
        fontSize = 8;
      } else if (songsPerSheet > 40) {
        fontSize = 9;
      } else if (songsPerSheet > 30) {
        fontSize = 10;
      } else if (songsPerSheet > 25) {
        fontSize = 11;
      } else if (songsPerSheet > 20) {
        fontSize = 12;
      } else if (songsPerSheet > 16) {
        fontSize = 13;
      } else if (songsPerSheet > 12) {
        fontSize = 14;
      } else if (songsPerSheet > 10) {
        fontSize = 15;
      } else if (songsPerSheet > 8) {
        fontSize = 16;
      } else if (songsPerSheet > 6) {
        fontSize = 17;
      } else if (songsPerSheet > 4) {
        fontSize = 18;
      } else {
        fontSize = 20;
      }
      
      return fontSize;
    }

    function clearSheets() {
      while (sheetsContainer.firstChild) {
        sheetsContainer.removeChild(sheetsContainer.firstChild);
      }
    }

    function generateSheets() {
      const text = rawInput.value.trim();
      clearSheets();

      if (!text) {
        sheetsContainer.appendChild(emptyState);
        return;
      }

      // Songs are separated by a line containing --- (3 or more dashes)
      const rawSongs = text.split(/\n-{3,}\n/g).filter(s => s.trim().length > 0);
      const actualSongCount = rawSongs.length;

      let fontSize = parseInt(fontSizeSelect.value, 10) || 13;
      let totalPages = 1;
      let sheetsPerPage = 1;
      
      // Use auto-calculated font size if enabled
      if (autoFitToggle.checked) {
        totalPages = parseInt(totalPagesSelect.value, 10) || 2;
        sheetsPerPage = parseInt(sheetsPerPageSelect.value, 10) || 1;
        fontSize = calculateAutoFitFontSize(actualSongCount);
      }
      
      const columns = columnsSelect.value === "1" ? "columns-1" : "columns-2";
      const churchNameText = churchName.value.trim();

      // Total A4 sheets = physical pages √ó sheets per page
      const totalSheets = totalPages * sheetsPerPage;
      
      // Calculate songs per sheet
      const songsPerSheet = Math.ceil(actualSongCount / totalSheets);

      // Create multiple A4 sheets
      for (let sheetNum = 0; sheetNum < totalSheets; sheetNum++) {
        const sheet = document.createElement("div");
        sheet.className = "sheet " + columns;
        sheet.style.fontSize = fontSize + "px";

        // Add church name header if provided
        if (churchNameText) {
          const headerEl = document.createElement("div");
          headerEl.className = "church-header";
          headerEl.textContent = churchNameText;
          sheet.appendChild(headerEl);
        }

        // Calculate song range for this sheet
        const startIndex = sheetNum * songsPerSheet;
        const endIndex = Math.min(startIndex + songsPerSheet, actualSongCount);

        // Add songs to this sheet
        for (let i = startIndex; i < endIndex; i++) {
          const block = rawSongs[i];
          const trimmed = block.trim();
          if (!trimmed) continue;

          const lines = trimmed.split("\n").map(l => l.trim());
          if (lines.length === 0) continue;

          const title = lines[0];
          const bodyLines = lines.slice(1).join("\n");

          const songEl = document.createElement("div");
          songEl.className = "song";

          const titleEl = document.createElement("div");
          titleEl.className = "song-title";

          const numberSpan = document.createElement("span");
          numberSpan.className = "song-number";
          numberSpan.textContent = (i + 1) + ".";

          const titleSpan = document.createElement("span");
          titleSpan.textContent = " " + title;

          titleEl.appendChild(numberSpan);
          titleEl.appendChild(titleSpan);

          const bodyEl = document.createElement("div");
          bodyEl.className = "song-body";
          bodyEl.style.fontSize = fontSize - 1 + "px";
          bodyEl.textContent = bodyLines;

          songEl.appendChild(titleEl);
          songEl.appendChild(bodyEl);

          sheet.appendChild(songEl);
        }

        sheetsContainer.appendChild(sheet);
      }
    }

    generateBtn.addEventListener("click", () => {
      generateSheets();
      updateAutoFitInfo();
    });

    // Optional: live update on change of font/columns
    fontSizeSelect.addEventListener("change", () => {
      if (!autoFitToggle.checked && rawInput.value.trim()) generateSheets();
    });
    columnsSelect.addEventListener("change", () => {
      if (rawInput.value.trim()) {
        generateSheets();
        updateAutoFitInfo();
      }
    });
    churchName.addEventListener("change", () => {
      if (rawInput.value.trim()) generateSheets();
    });
    
    // Update info when user pastes songs
    rawInput.addEventListener("input", () => {
      updateAutoFitInfo();
    });
  </script>
</body>
</html>


